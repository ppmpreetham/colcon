<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Font Previewer</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        #custom-font-style {
            display: none;
        }
    </style>
    <style id="custom-font-style"></style>
</head>
<body>
    <!-- <button class="ui-btn">
        <span>
          Button 
        </span>
    </button> -->

    <div style="display: flex; align-items: center; justify-content: flex-start;">
        <label for="background-color-input">Background color:</label>
        <input type="color" id="background-color-input" oninput="changeBackgroundColor()" value="#ffffff">
    </div>

    <div style="display: flex; align-items: center; justify-content: flex-start;">
        <label for="font-size-slider">Font size:</label>
        <input type="range" id="font-size-slider" min="10" max="50" value="30" oninput="changeFontSize()">
    </div>
    <input type="file" id="font-file" accept=".ttf,.otf,.woff,.woff2" onchange="loadCustomFont()">
    <p id="content" style="font-family: inherit; font-size: 30px; outline: none;" contenteditable>The quick brown fox jumps over the lazy dog</p>

    <script>
        function changeFontSize() {
            const fontSize = document.getElementById('font-size-slider').value;
            document.getElementById('content').style.fontSize = fontSize + 'px';
        }
        
        function changeBackgroundColor() {
            const color = document.getElementById('background-color-input').value;
            document.body.style.backgroundColor = color;
            const r = parseInt(color.substring(1, 3), 16);
            const g = parseInt(color.substring(3, 5), 16);
            const b = parseInt(color.substring(5, 7), 16);
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            // https://www.w3.org/TR/WCAG21/#dfn-relative-luminance
            // http://colorspace.r-forge.r-project.org/reference/contrast_ratio.html
        }

        function loadCustomFont() {
            const fontFile = document.getElementById('font-file').files[0];

            // Font Face API !?
            if ('FontFace' in window) {
                const fontFamily = 'My Custom Font';

                const customFontStyle = document.getElementById('custom-font-style');
                customFontStyle.innerHTML = `
                    @font-face {
                        font-family: '${fontFamily}';
                        src: url(${URL.createObjectURL(fontFile)}) format('${getFontFormat(fontFile.name)}');
                        font-weight: normal;
                        font-style: normal;
                    }

                    #content {
                        font-family: '${fontFamily}', sans-serif;
                    }
                `;

                const customFont = new FontFace(fontFamily, `
                    url(${URL.createObjectURL(fontFile)}) format('${getFontFormat(fontFile.name)}')
                `, {
                    weight: 'normal',
                    style: 'normal'
                });
                
                customFont.load().then((font) => {
                    document.fonts.add(font);
                    document.getElementById('content').style.fontFamily = `"${fontFamily}", sans-serif`;
                }).catch((error) => {
                    console.error('Error loading custom font:', error);
                });
            } else {
                console.error('Font Face API is not supported in this browser.');
            }
        }

        function getFontFormat(fileName) {
            const extension = fileName.split('.').pop().toLowerCase();
            switch (extension) {
                case 'ttf':
                    return 'truetype';
                case 'otf':
                    return 'opentype';
                case 'woff':
                    return 'woff';
                case 'woff2':
                    return 'woff2';
                default:
                    return '';
            }
        }

    </script>
</body>
</html>
